<!DOCTYPE html>
<html>
  <head>
    <title>Report Visualization</title>
    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  </head>
<body>
  <h1>Report Visualization</h1>

  <form method="post">
    {% csrf_token %}
    {{ form.as_p }}  # Render all form fields, including data_points checkboxes
    <button type="submit">Generate Report</button>
  </form>

  {% if figure %}
    <div id="report-plot"></div>
    <script>
      // Access report URL from context
      var figureUrl = "{{ report_url }}";

      fetch(figureUrl)
        .then(response => response.json())
        .then(data => {
          var figure = data; // Assuming data contains the figure definition
          Plotly.newPlot('report-plot', figure);
        });
    </script>
  {% endif %}
</body>
</html>